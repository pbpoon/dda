{% extends 'list.html' %}
{% load static %}
{% load public %}
{% block headline %}
    {{ object|verbose_name|default_if_none:'' }}
{% endblock %}
{% block content %}
    <button class="btn waves-effect blue">新建客户</button>
    {#    <script src="{% static 'js/materialize-autocomplete/jquery.materialize-autocomplete.js' %}"></script>#}
    <form action="" method="post">
        {#        <script src="{% static 'js/autocomplete.js' %}"></script>#}
        {{ form.meida }}
        <div class="card-panel input-field">
            <ul>
                {{ form.as_p }}
            </ul>
            {% csrf_token %}

        </div>


        {% if formset %}
            <div class="card-panel">
                <i>销售单明细</i>
                <table class="table">
                    {{ formset.management_form }}

                    {% for form in formset.forms %}
                        {% if forloop.first %}
                            <thead>
                            <tr>
                                {% for field in form.visible_fields %}
                                    <th>{{ field.label|capfirst }}</th>
                                {% endfor %}
                            </tr>
                            </thead>
                        {% endif %}
                        <tr class="formset_row">
                            {% for field in form.visible_fields %}
                                <td>
                                    {#                                    Include the hidden fields in the form#}
                                    {% if forloop.first %}
                                        {% for hidden in form.hidden_fields %}
                                            {{ hidden }}
                                        {% endfor %}
                                    {% endif %}
                                    {{ field.errors.as_ul }}
                                    {{ field }}
                                </td>
                            {% endfor %}
                        </tr>
                    {% endfor %}
                </table>
            </div>
        {% endif %}
        <input class="btn btn-block" type="submit" value="确定">
    </form>

    {#    <script src="{% static 'js/jquery.cityselect.js' %}"></script>#}
{% endblock %}
{% block footer %}
    {{ form.media }}
    {#    <style>#}
    {#        .select2-search__field {#}
    {#            width: 100% !important;#}
    {#            z-index: 215000000 !important;#}
    {#        }#}
    {#    </style>#}
    {{ block.super }}

    {#    <script>#}
    {##}
    {#        var ajax_url = '{% url 'get_address' %}';#}
    {#        var DATA;#}
    {##}
    {#        function get_address() {#}
    {#            console.log($('.prov').val())#}
    {#            $.ajax({#}
    {#                url: ajax_url,#}
    {#                method: 'GET',#}
    {#                data: {#}
    {#                    'prov': $('.prov').val(),#}
    {#                },#}
    {#                success: function (data) {#}
    {#                    DATA = data;#}
    {#                    return change_city()#}
    {##}
    {#                }#}
    {#            })#}
    {#        }#}
    {##}
    {#        function change_city() {#}
    {#            var val = $('.prov').val();#}
    {#$('.city').children().not(':eq(0)').remove();#}
    {#            $('.city').html("")#}
    {#            for (var c  in DATA) {#}
    {#                $('.city').append("<option value=" + DATA[c]['id'] + ">" + DATA[c]['name'] + "</option>");#}
    {#            }#}
    {#            $(".city").formSelect();#}
    {#        }#}
    {##}
    {#        $('.prov').on('change', function () {#}
    {#            get_address('city');#}
    {#        });#}
    {#        $('.checkbox').on('change', function () {#}
    {#            if ($(this).checked) {#}
    {#                $('.prov').attr('disable', 'disable');#}
    {#                $('.city').prop('disable', true);#}
    {#            }#}
    {#        })#}

    {#</script>#}

{% endblock %}
<script>

    {% block domready %}
        {{ block.super }}
        {#$('.select2-selection--single').append("<div style='z-index:999;' class='right' id='add'>添加</div>");#}
        {#$('#add').on('click', function (e) {#}
        {#    md_package_list.modal('open')#}
        {#md_package_list.modal('open');#}

    {% endblock %}
</script>
