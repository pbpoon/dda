{% load public %}
{#<div class="row">#}
<div class="col s12">
    <div><span class="title">{{ object }}</span>
        <p>{{ package.get_piece }}件 / {{ package.get_part_number|length }}夹 /
            {{ package.get_quantity }}{{ package.product.get_uom }}</p>
        <div class="right">
            <button class="btn-small" onclick="all_select()">全选</button>
            <button class="btn-small" onclick="all_no_select()">全不选</button>
        </div>
    </div>
    <ul class="tabs">
        {% for part_number in package.get_part_number %}
            <li class="tab col s3"><a href="#{{ part_number }}">{{ part_number }}#</a></li>
        {% endfor %}
    </ul>
    {% regroup package.items.all by part_number as package_list %}
    {% with select_slabs=cart.get_select_slabs %}

        {% for part_number in package_list %}
            <div id="{{ part_number.grouper }}" class="col s12">
                <table>
                    <thead>
                    <tr>
                        <th><p>
                            <label>
                                <input type="checkbox" name="select_part"
                                       data-part="{{ part_number.grouper }}"/>
                                <span>选择</span>
                            </label>
                        </p>
                        </th>
                        <th>规格</th>
                        <th>面积</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for item in part_number.list %}
                        <tr>
                            <td>
                                <p>
                                    <label>
                                        <input form="select_slab_form" data-quantity="{{ item.get_quantity }}"
                                               type="checkbox" name="select"
                                                {% if item.get_slab_id|stringformat:"i" in select_slabs %}
                                               checked="checked"
                                                {% endif %}
                                               value="{{ item.get_slab_id }}"/>
                                        <span>{{ item.line }}</span>
                                    </label>
                                </p>
                            </td>
                            <td>{{ item }}
                                <a href="#!"
                                   onclick="edit_item({{ item.id }},'{% url 'package_list_draft_item_edit' %}')">
                                    修改
                                </a>
                            </td>
                            <td>{{ item.get_quantity }}</td>
                            <td>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                    <tfoot>
                    <tr>
                        <td>第 {{ part_number.grouper }} 夹</td>
                        <td>{{ package|add_arg:part_number.grouper|call:'get_piece' }}件</td>
                        <td>{{ package|add_arg:part_number.grouper|call:'get_quantity' }}m2</td>
                        <td></td>
                    </tr>
                    </tfoot>
                </table>

            </div>

        {% endfor %}
    {% endwith %}

    <form id="select_slab_form" action="{{ package.get_absolute_url }}">
        <input type="hidden" name="product"
               value="{% if package.product %}{{ package.product.id }}{% else %}{{ package.id }}{% endif %}">
    </form>

</div>